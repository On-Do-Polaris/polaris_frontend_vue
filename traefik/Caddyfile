{
    # HTTPS 자동 발급 비활성화 (Traefik에서 처리)
    auto_https off
    # Admin API 비활성화 (프로덕션 보안)
    admin off
}

:80 {
    # 정적 파일 루트 디렉토리
    root * /srv

    # Gzip 압축 활성화
    encode gzip

    # SPA 라우팅: 파일이 없으면 index.html로 폴백
    try_files {path} /index.html

    # 정적 파일 캐싱 설정 (JS, CSS, 이미지, 폰트 등)
    @static {
        path *.js *.css *.png *.jpg *.jpeg *.gif *.ico *.svg *.woff *.woff2 *.ttf *.eot
    }
    header @static {
        Cache-Control "public, max-age=31536000, immutable"
    }

    # 보안 헤더 추가
    header {
        # Clickjacking 방지
        X-Frame-Options "SAMEORIGIN"
        # MIME 타입 스니핑 방지
        X-Content-Type-Options "nosniff"
        # XSS 필터 활성화
        X-XSS-Protection "1; mode=block"
        # 리퍼러 정책 (선택적)
        Referrer-Policy "strict-origin-when-cross-origin"
    }

    # 정적 파일 서버 활성화
    file_server

    # 에러 페이지 처리 (404 등을 index.html로)
    handle_errors {
        @404 {
            expression {http.error.status_code} == 404
        }
        rewrite @404 /index.html
        file_server
    }

    # 로그 설정 (선택적)
    log {
        output stdout
        format console
    }
}
